{"version":3,"file":"js/shop/wishlist.js","mappings":"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","sources":["webpack://skunkmonkey/./shop/static/js/shop/wishlist-manager.js","webpack://skunkmonkey/./static/js/ajax_helper.js","webpack://skunkmonkey/./static/js/api-client.js","webpack://skunkmonkey/webpack/bootstrap","webpack://skunkmonkey/webpack/runtime/define property getters","webpack://skunkmonkey/webpack/runtime/hasOwnProperty shorthand","webpack://skunkmonkey/webpack/runtime/make namespace object","webpack://skunkmonkey/./shop/static/js/shop/wishlist-initializer.js"],"sourcesContent":["/**\n * Wishlist Manager\n * Handles wishlist functionality for the shop\n */\n\nimport apiClient from '/static/js/api-client.js';\n\n/**\n * WishlistManager class for handling wishlist functionality\n */\nclass WishlistManager {\n    /**\n     * Initialize the WishlistManager\n     */\n    constructor() {\n        // Initialize properties BEFORE calling methods that use them\n        this.toastQueue = []; // Queue for storing toast notifications\n        this.processingToast = false; // Flag to track if a toast is currently being processed\n        this.debug = true; // Enable debug logging\n        this.wishlistItems = new Set(); // Store wishlist item IDs <-- Initialize this FIRST\n\n        this.initialize(); // Now call initialize, which uses this.wishlistItems\n    }\n\n    /**\n     * Initialize the wishlist manager with error handling\n     */\n    initialize() {\n        try {\n            // Initialize the wishlist items set from any data available\n            this.initializeWishlistItems();\n            this.initEventListeners();\n            this.checkSweetAlert2Availability();\n            \n            // Process any queued toasts once SweetAlert2 is available\n            document.addEventListener('swal2-initialized', () => {\n                this.log('SweetAlert2 initialized event received, processing queued toasts');\n                this.processToastQueue();\n            });\n        } catch (error) {\n            console.error('Error initializing Wishlist Manager:', error);\n        }\n    }\n\n    /**\n     * Initialize the wishlist items set from the DOM\n     */\n    initializeWishlistItems() {\n        // Try to get wishlist count from the DOM\n        const wishlistCountElements = document.querySelectorAll('.wishlist-count');\n        if (wishlistCountElements.length > 0) {\n            const count = parseInt(wishlistCountElements[0].textContent, 10);\n            this.log('Initial wishlist count:', count);\n        }\n\n        // Try to collect wishlist product IDs from data attributes or classes\n        document.querySelectorAll('.remove-wishlist-btn, .wishlist-btn.active').forEach(btn => {\n            const productId = btn.dataset.productId;\n            if (productId) {\n                this.wishlistItems.add(productId);\n                this.log('Added product to initial wishlist set:', productId);\n            }\n        });\n\n        // Look for wishlist product IDs in a data attribute on the body or a hidden input\n        const wishlistDataElement = document.getElementById('wishlist-data');\n        if (wishlistDataElement) {\n            try {\n                const wishlistData = JSON.parse(wishlistDataElement.value);\n                if (Array.isArray(wishlistData)) {\n                    wishlistData.forEach(id => this.wishlistItems.add(id.toString()));\n                    this.log('Initialized wishlist items from data element:', wishlistData);\n                }\n            } catch (e) {\n                console.error('Error parsing wishlist data:', e);\n            }\n        }\n\n        this.log('Initialized wishlist items:', [...this.wishlistItems]);\n    }\n\n    /**\n     * Log debug messages if debug mode is enabled\n     * @param {...any} args - Arguments to log\n     */\n    log(...args) {\n        if (this.debug) {\n            console.log('[WishlistManager]', ...args);\n        }\n    }\n\n    /**\n     * Check if SweetAlert2 is available and log the result\n     */\n    checkSweetAlert2Availability() {\n        if (typeof window.Swal !== 'undefined') {\n            this.log('SweetAlert2 is available for WishlistManager.');\n            // Dispatch an event to signal SweetAlert2 is available\n            document.dispatchEvent(new Event('swal2-initialized'));\n        } else {\n            console.warn('SweetAlert2 is not available for WishlistManager. Toast notifications will fall back to alerts.');\n            // Set up a listener to check again when main.js might have loaded SweetAlert2\n            window.addEventListener('load', () => {\n                setTimeout(() => {\n                    if (typeof window.Swal !== 'undefined') {\n                        this.log('SweetAlert2 became available after window load');\n                        document.dispatchEvent(new Event('swal2-initialized'));\n                    } else {\n                        // Try to load SweetAlert2 dynamically as a last resort\n                        this.loadSweetAlert2Dynamically();\n                    }\n                }, 500);\n            });\n        }\n    }\n\n    /**\n     * Try to load SweetAlert2 dynamically if it's not available\n     */\n    loadSweetAlert2Dynamically() {\n        if (typeof window.Swal === 'undefined') {\n            this.log('Attempting to load SweetAlert2 dynamically');\n            \n            const script = document.createElement('script');\n            script.src = 'https://cdn.jsdelivr.net/npm/sweetalert2@11';\n            script.onload = () => {\n                this.log('SweetAlert2 loaded dynamically');\n                document.dispatchEvent(new Event('swal2-initialized'));\n            };\n            script.onerror = (e) => {\n                console.error('Failed to load SweetAlert2 dynamically:', e);\n            };\n            document.head.appendChild(script);\n        }\n    }\n\n    /**\n     * Initialize event listeners for wishlist buttons\n     */\n    initEventListeners() {\n        // Use a single unified selector for all wishlist buttons\n        const wishlistBtnSelector = '.wishlist-btn, .add-to-wishlist-btn, .remove-wishlist-btn';\n        \n        // Handle existing buttons\n        document.querySelectorAll(wishlistBtnSelector).forEach(btn => {\n            if (!btn.hasAttribute('data-event-bound')) {\n                btn.setAttribute('data-event-bound', 'true');\n                btn.addEventListener('click', (e) => {\n                    e.preventDefault();\n                    this.handleWishlistToggle(e);\n                });\n            }\n        });\n\n        // Use delegation for future buttons\n        document.addEventListener('click', (event) => {\n            const toggleBtn = event.target.closest(wishlistBtnSelector);\n            if (toggleBtn && !toggleBtn.hasAttribute('data-event-bound')) {\n                // Check if this specific button already has a direct listener to avoid double handling\n                if (!toggleBtn.getAttribute('data-event-bound')) {\n                    toggleBtn.setAttribute('data-event-bound', 'true'); // Mark for delegation handling\n                     // Add the listener directly here as well, ensures it works even if mutation observer misses it\n                    toggleBtn.addEventListener('click', (e) => {\n                        e.preventDefault();\n                        this.handleWishlistToggle(e);\n                    });\n                    // Trigger the handler immediately for this click\n                    this.handleWishlistToggle(event);\n                    event.preventDefault();\n                }\n            }\n        });\n\n\n        // Add a mutation observer to handle dynamically added buttons\n        this.setupMutationObserver();\n\n        this.log('Wishlist event listeners initialized');\n    }\n\n    /**\n     * Setup mutation observer to watch for dynamically added buttons\n     */\n    setupMutationObserver() {\n        const wishlistBtnSelector = '.wishlist-btn:not([data-event-bound]), .add-to-wishlist-btn:not([data-event-bound]), .remove-wishlist-btn:not([data-event-bound])';\n        const observer = new MutationObserver((mutations) => {\n            mutations.forEach((mutation) => {\n                if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {\n                    mutation.addedNodes.forEach((node) => {\n                        if (node.nodeType === Node.ELEMENT_NODE) {\n                            // Check if the added node itself is a button\n                            if (node.matches(wishlistBtnSelector)) {\n                                this.bindWishlistButtonListener(node);\n                            }\n                            // Check for buttons within the added node\n                            const wishlistBtns = node.querySelectorAll(wishlistBtnSelector);\n                            wishlistBtns.forEach((btn) => {\n                                this.bindWishlistButtonListener(btn);\n                            });\n                        }\n                    });\n                }\n            });\n        });\n\n        observer.observe(document.body, {\n            childList: true,\n            subtree: true\n        });\n        this.log('Mutation observer set up for wishlist buttons.');\n    }\n\n     /**\n     * Binds the click listener to a wishlist button if not already bound.\n     * @param {HTMLElement} btn - The button element.\n     */\n    bindWishlistButtonListener(btn) {\n        if (!btn.hasAttribute('data-event-bound')) {\n            btn.setAttribute('data-event-bound', 'true');\n            btn.addEventListener('click', (e) => {\n                e.preventDefault();\n                this.handleWishlistToggle(e);\n            });\n            this.log('Bound listener to dynamically added button:', btn);\n        }\n    }\n\n    /**\n     * Handle toggling an item in the wishlist\n     * Handle toggling an item in the wishlist.\n     * REVISED: Stores original content, restores in finally.\n     * @param {Event} event - The click event\n     */\n    handleWishlistToggle(event) {\n        const button = event.currentTarget || event.target.closest('.wishlist-btn, .add-to-wishlist-btn, .remove-wishlist-btn');\n        if (!button) {\n            this.log('Wishlist toggle handler called but no button found.');\n            return;\n        }\n\n        // Prevent multiple rapid clicks\n        if (button.classList.contains('disabled')) {\n            this.log('Button already processing, ignoring click.');\n            return;\n        }\n\n        const productId = button.dataset.productId;\n        if (!productId) {\n            console.error(\"Wishlist button missing data-product-id:\", button);\n            this.showToast('Error', 'Product ID missing.', 'error');\n            return; // Stop if no product ID\n        }\n        const productName = button.dataset.productName || 'Product';\n        const isCurrentlyInWishlist = this.wishlistItems.has(productId);\n        this.log(`Toggling product ${productId}: Currently in Wishlist? ${isCurrentlyInWishlist}`);\n\n        // --- Store original content BEFORE showing spinner ---\n        const originalContent = button.innerHTML;\n        let originalDisabledState = button.disabled; // Store original disabled state\n\n        // Show spinner and disable\n        button.innerHTML = '<span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>';\n        button.disabled = true; // Use disabled attribute\n        button.classList.add('disabled'); // Keep class for styling\n\n        const url = `/shop/wishlist/toggle/${productId}/`;\n        this.log('POSTing to:', url);\n\n        apiClient.post(url, { product_id: productId })\n            .then(response => {\n                // ... (Keep the .then() logic for parsing, determining final state, updating Set, showing toast, removing item) ...\n                this.log('Raw response:', response);\n                let data;\n                try {\n                    if (typeof response === 'object' && response !== null) data = response;\n                    else if (typeof response === 'string' && response.trim() !== '') data = JSON.parse(response);\n                    else throw new Error('Invalid or empty response');\n                } catch (error) {\n                    console.error('Parse error:', error, 'Raw:', response);\n                    this.showToast('Error', 'Received invalid data.', 'error');\n                    // Return an object indicating error for finally block\n                    return { finalState: isCurrentlyInWishlist, errorOccurred: true };\n                }\n\n                let finalIsInWishlist = isCurrentlyInWishlist;\n                let actionSucceeded = false;\n                if (typeof data.success === 'boolean' && data.success) {\n                    actionSucceeded = true;\n                    // Determine final state based on server response\n                    if (data.isInWishlist !== undefined) {\n                        finalIsInWishlist = data.isInWishlist;\n                    } else if (data.added !== undefined) {\n                        finalIsInWishlist = data.added;\n                    } else if (data.removed !== undefined) {\n                        finalIsInWishlist = !data.removed;\n                    } else {\n                        // Fallback if server doesn't provide state (less ideal)\n                        finalIsInWishlist = !isCurrentlyInWishlist;\n                        this.log('Warning: Server response did not explicitly state added/removed/isInWishlist status. Inferring state.');\n                    }\n\n                    this.log('API Success. Final state:', finalIsInWishlist);\n                    // Update local set\n                    if (finalIsInWishlist) this.wishlistItems.add(productId);\n                    else this.wishlistItems.delete(productId);\n                    this.log('Updated local Set:', [...this.wishlistItems]);\n\n                    // Show toast\n                    const actionType = finalIsInWishlist ? 'Added to' : 'Removed from';\n                    this.showToast(`${actionType} Wishlist`, data.message || `${productName} ${actionType.toLowerCase()} wishlist.`, finalIsInWishlist ? 'success' : 'info');\n\n                    // Update global count if provided\n                    if (data.wishlist_count !== undefined) {\n                        this.updateWishlistCount(data.wishlist_count);\n                    }\n\n                    // Handle removal from wishlist page\n                    if (!finalIsInWishlist && window.location.pathname.includes('/wishlist/')) {\n                         this.removeItemFromWishlistPage(button);\n                    }\n                } else {\n                    actionSucceeded = false;\n                    this.log('API Failure:', data.message || data.error || 'Unknown error.');\n                    this.showToast('Error', data.message || data.error || 'Failed to update.', 'error');\n                }\n                // Return state for finally block\n                return { finalState: finalIsInWishlist, errorOccurred: !actionSucceeded };\n            })\n            .catch(error => {\n                // ... (Keep the .catch() logic for logging, showing error toast) ...\n                console.error('API Call Error:', error);\n                let errorMessage = 'Update failed. Check connection.';\n                 if (error && typeof error === 'object') {\n                     errorMessage = error.message || (error.response && error.response.data && (error.response.data.detail || error.response.data.error)) || errorMessage;\n                 } else if (typeof error === 'string') {\n                     errorMessage = error;\n                 }\n                this.showToast('Error', errorMessage, 'error');\n                // Return state for finally block\n                return { finalState: isCurrentlyInWishlist, errorOccurred: true };\n            })\n            .finally(() => { // Removed the result parameter as it's not reliably passed from catch/then in all scenarios\n                // --- RELIABLE SPINNER REMOVAL ---\n                // Always get the definitive state from the Set *inside* finally\n                const finalState = this.wishlistItems.has(productId);\n                this.log(`Finally block. Definitive final state from Set: ${finalState}. Restoring button ${productId}.`);\n\n                 const buttonsToRestore = document.querySelectorAll(`.wishlist-btn[data-product-id=\"${productId}\"], .add-to-wishlist-btn[data-product-id=\"${productId}\"], .remove-wishlist-btn[data-product-id=\"${productId}\"]`);\n\n                 buttonsToRestore.forEach(btn => {\n                    // 1. Restore original content if it's currently showing ONLY the spinner\n                    const spinner = btn.querySelector('span.spinner-border');\n                    if (spinner && btn.children.length === 1 && btn.firstChild === spinner) {\n                         btn.innerHTML = originalContent;\n                         this.log(`Restored original content for button:`, btn);\n                    } else {\n                         this.log(`Button content not just spinner, skipping content restore for:`, btn);\n                    }\n\n                    // 2. Remove disabled state/class\n                    btn.disabled = originalDisabledState; // Restore original disabled property\n                    btn.classList.remove('disabled', 'wishlist-btn-active'); // Remove active class too\n\n                    // 3. Update visual state (icon, classes) AFTER restoring content/enabled state\n                    this.updateWishlistButtonVisualState(btn, finalState); // Use definitive finalState from Set\n                 });\n\n                // Update global count based on final Set size\n                this.updateWishlistCount(this.wishlistItems.size);\n                this.log(`Finished processing toggle for product ${productId}.`);\n            });\n    }\n\n    /**\n     * Update all buttons for a specific product ID to reflect the current wishlist state.\n     * @param {string} productId - The product ID.\n     * @param {boolean} isInWishlist - The definitive state whether the product IS in the wishlist.\n     */\n    updateAllButtonsForProduct(productId, isInWishlist) {\n        if (!productId) return;\n        this.log(`Updating all buttons for product ${productId} to state: ${isInWishlist ? 'IN wishlist' : 'NOT in wishlist'}`);\n\n        const buttons = document.querySelectorAll(\n            `.wishlist-btn[data-product-id=\"${productId}\"], ` +\n            `.add-to-wishlist-btn[data-product-id=\"${productId}\"], ` +\n            `.remove-wishlist-btn[data-product-id=\"${productId}\"]`\n        );\n\n        if (buttons.length === 0) {\n             this.log(`No buttons found for product ${productId} to update.`);\n             return;\n        }\n\n        buttons.forEach(button => {\n             this.updateWishlistButtonVisualState(button, isInWishlist);\n             // Ensure button is enabled after update (might have been disabled during API call)\n             button.classList.remove('disabled', 'wishlist-btn-active');\n             // Restore original content if spinner was present (safer check)\n             const spinner = button.querySelector('.spinner-border');\n             if(spinner) {\n                // Need to know what the original content *should* be based on state\n                // Assuming simple icon or text change happens in updateWishlistButtonVisualState\n                // If original content varies wildly, this needs more complex state management\n             }\n        });\n    }\n\n    /**\n     * Updates the visual appearance (classes, icon, title, aria-label, href) of a single wishlist button.\n     * SIMPLIFIED: Only sets state based on isInWishlist, does NOT handle spinner removal or content restoration.\n     * @param {HTMLElement} button - The button element to update.\n     * @param {boolean} isInWishlist - Whether the product IS currently in the wishlist.\n     */\n    updateWishlistButtonVisualState(button, isInWishlist) {\n        if (!button) return;\n\n        const productName = button.dataset.productName || 'this product';\n        const productId = button.dataset.productId;\n        const icon = button.querySelector('i');\n\n        // --- Update Button Classes ---\n        if (isInWishlist) {\n            button.classList.remove('add-to-wishlist-btn');\n            button.classList.add('remove-wishlist-btn', 'active');\n        } else {\n            button.classList.remove('remove-wishlist-btn', 'active');\n            button.classList.add('add-to-wishlist-btn');\n        }\n\n        // --- Update Icon Classes ---\n        if (icon) {\n            // Ensure correct icon state based on isInWishlist\n            if (isInWishlist) {\n                // ** CHANGE: Set SOLID heart as the default for \"Remove\" state **\n                icon.classList.remove('far', 'fa-heart-broken', 'fa-heart-o'); // Remove others\n                icon.classList.add('fas', 'fa-heart');                     // Add SOLID heart\n            } else {\n                // For \"Add\" state: Use regular outline heart (FA5 Free)\n                icon.classList.remove('fas', 'fa-heart-broken', 'fa-heart', 'fa-heart-o'); // Remove others\n                icon.classList.add('far', 'fa-heart');                  // Add outline heart\n            }\n        }\n\n        // --- Update Title and Aria-label ---\n        if (isInWishlist) {\n            button.setAttribute('title', `Remove ${productName} from wishlist`);\n            button.setAttribute('aria-label', `Remove ${productName} from wishlist`);\n        } else {\n            button.setAttribute('title', `Add ${productName} to wishlist`);\n            button.setAttribute('aria-label', `Add ${productName} to wishlist`);\n        }\n\n        // --- Always update href ---\n        if (productId) {\n            button.setAttribute('href', `/shop/wishlist/toggle/${productId}/`);\n        }\n\n        // --- Mark state as set (for observer/debugging) ---\n        button.setAttribute('data-visual-state-set', isInWishlist ? 'in' : 'out');\n\n        // --- DO NOT handle spinner/disabled here - handled in finally block ---\n        // --- DO NOT handle innerHTML restoration here - handled in finally block ---\n    }\n\n    /**\n     * Remove an item visually from the wishlist page after successful removal via API.\n     * @param {HTMLElement} button - The 'remove' button that was clicked.\n     */\n    removeItemFromWishlistPage(button) {\n        const card = button.closest('.product-card, .wishlist-item');\n        if (!card) {\n            this.log('Could not find product card/item to remove from wishlist page.');\n            return;\n        }\n\n        // Find the most appropriate container to remove (e.g., the grid column or list item)\n        const container = card.closest('.col, .wishlist-item-container, li, div.product-entry'); // Add more selectors if needed\n        const elementToRemove = container || card; // Fallback to removing the card itself\n\n        this.log('Removing wishlist item element:', elementToRemove);\n\n        // Animate removal\n        elementToRemove.style.transition = 'opacity 0.5s ease, transform 0.5s ease, height 0.5s ease, margin 0.5s ease, padding 0.5s ease';\n        elementToRemove.style.opacity = '0';\n        elementToRemove.style.transform = 'scale(0.8)';\n        elementToRemove.style.height = '0'; // Collapse height\n        elementToRemove.style.marginTop = '0';\n        elementToRemove.style.marginBottom = '0';\n        elementToRemove.style.paddingTop = '0';\n        elementToRemove.style.paddingBottom = '0';\n        elementToRemove.style.borderWidth = '0'; // Collapse border\n\n\n        setTimeout(() => {\n            elementToRemove.remove();\n            this.log('Wishlist item removed from DOM.');\n\n            // Check if wishlist is now empty\n            const remainingItems = document.querySelectorAll('.product-card, .wishlist-item');\n            this.log('Remaining wishlist items on page:', remainingItems.length);\n            if (remainingItems.length === 0) {\n                this.displayEmptyWishlistMessage();\n            } else {\n                // Update count just in case it wasn't updated by API response\n                this.updateWishlistCount(remainingItems.length);\n            }\n        }, 500); // Match animation duration\n    }\n\n    /**\n     * Displays a message indicating the wishlist is empty.\n     */\n    displayEmptyWishlistMessage() {\n         this.log('Displaying empty wishlist message.');\n        const mainContent = document.querySelector('.container main, .wishlist-container, .content-section, #main-content'); // More robust selector\n        if (mainContent) {\n            // Clear existing content within the main area *carefully*\n            // Avoid wiping out headers/footers if they are inside the selected container\n             const wishlistGrid = mainContent.querySelector('.row.wishlist-items, #wishlist-items-container'); // Target specific container if possible\n             const containerToEmpty = wishlistGrid || mainContent;\n\n             containerToEmpty.innerHTML = `\n                <div class=\"empty-wishlist alert alert-info text-center my-5 col-12\">\n                    <i class=\"fas fa-heart-broken fa-3x mb-3\"></i>\n                    <h3 class=\"alert-heading\">Your Wishlist is Empty</h3>\n                    <p class=\"lead mb-4\">You haven't added any products yet. Start exploring!</p>\n                    <a href=\"/shop/\" class=\"btn btn-primary btn-lg\">\n                        <i class=\"fas fa-shopping-bag me-2\"></i>Browse Products\n                    </a>\n                </div>\n            `;\n            // Ensure count is zero\n            this.updateWishlistCount(0);\n        } else {\n             this.log('Could not find main content area to display empty wishlist message.');\n        }\n    }\n\n    /**\n     * Update the wishlist count in the UI\n     * @param {number} count - The new wishlist count\n     */\n    updateWishlistCount(count) {\n        if (count !== undefined && !isNaN(count)) {\n            this.log('Updating wishlist count UI elements to:', count);\n            document.querySelectorAll('.wishlist-count').forEach(element => {\n                element.textContent = count;\n                // Optional: Add animation or visual feedback on change\n                element.classList.add('animate__animated', 'animate__bounceIn');\n                element.onanimationend = () => element.classList.remove('animate__animated', 'animate__bounceIn');\n\n\n                // Hide/show container based on count\n                 const counterContainer = element.closest('.wishlist-count-container') || element; // Use element itself if no specific container\n                if (counterContainer) {\n                    counterContainer.style.display = count === 0 ? 'none' : ''; // Use style.display for better control\n                }\n            });\n        } else {\n             this.log('Invalid count received for UI update:', count);\n        }\n    }\n\n    /**\n     * Add a toast to the queue and process it\n     * @param {string} title - The notification title\n     * @param {string} message - The notification message (can be HTML).\n     * @param {string} type - Notification type ('success', 'error', 'warning', 'info', 'question').\n     */\n    showToast(title, message, type = 'info') {\n        this.log('Queueing toast:', { title, message, type });\n        this.toastQueue.push({ title, message, type });\n        if (!this.processingToast) {\n            this.processToastQueue();\n        }\n    }\n\n    /**\n     * Process the next toast notification in the queue.\n     */\n    processToastQueue() {\n        if (this.toastQueue.length === 0) {\n            this.processingToast = false;\n            this.log('Toast queue empty.');\n            return;\n        }\n\n        this.processingToast = true;\n        const toastToShow = this.toastQueue.shift();\n        this.log('Processing toast from queue:', toastToShow);\n\n        this.displayToast(toastToShow.title, toastToShow.message, toastToShow.type)\n            .finally(() => {\n                // Process next toast after a short delay to prevent rapid-fire toasts\n                setTimeout(() => {\n                    this.processToastQueue();\n                }, 300); // Adjust delay as needed\n            });\n    }\n\n    /**\n     * Display a toast notification using SweetAlert2 or fallback\n     * @param {string} title - The notification title\n     * @param {string} message - The notification message\n     * @param {string} message - The notification message (can be HTML).\n     * @param {string} type - Notification type ('success', 'error', 'warning', 'info', 'question').\n     * @returns {Promise} Resolves when the toast is displayed or fallback is shown.\n     */\n    displayToast(title, message, type) {\n        return new Promise((resolve) => {\n            this.log('Attempting to display toast:', { title, type });\n\n            // Use global showToast if specifically defined elsewhere (e.g., in main.js)\n            if (typeof window.showToast === 'function' && window.showToast !== this.showToast) { // Avoid recursion\n                this.log('Using global window.showToast function.');\n                try {\n                    window.showToast(title, message, type);\n                } catch (e) {\n                    console.error(\"Error calling global showToast:\", e);\n                    this.fallbackToast(title, message); // Fallback if global fails\n                }\n                resolve(); // Assume global function handles itself\n            }\n            // Use SweetAlert2 if available\n            else if (typeof window.Swal !== 'undefined') {\n                this.log('Using SweetAlert2 for toast.');\n                const iconType = type === 'danger' ? 'error' : type; // Map 'danger' to 'error' if needed\n\n                window.Swal.fire({\n                    title: title,\n                    html: message, // Allow HTML content\n                    icon: iconType,\n                    toast: true,\n                    position: 'top-end', // Common position for toasts\n                    showConfirmButton: false,\n                    timer: 3500, // Slightly longer timer\n                    timerProgressBar: true,\n                    customClass: {\n                        popup: 'custom-swal-toast', // Add custom class for styling\n                    },\n                    showCloseButton: true, // Allow users to close manually\n                    didOpen: (toast) => {\n                        toast.style.zIndex = '9999'; // Ensure visibility\n                        toast.addEventListener('mouseenter', window.Swal.stopTimer);\n                        toast.addEventListener('mouseleave', window.Swal.resumeTimer);\n                    }\n                }).then(resolve, resolve); // Resolve whether confirmed or timed out\n            }\n            // Fallback to standard alert\n            else {\n                this.log('SweetAlert2 not available, using fallback alert.');\n                this.fallbackToast(title, message);\n                resolve(); // Resolve after showing alert\n            }\n        });\n    }\n\n    /**\n     * Simple fallback alert mechanism.\n     */\n    fallbackToast(title, message) {\n         // Basic alert, strip HTML for safety if message might contain it\n         const cleanMessage = message.replace(/<[^>]*>/g, ''); // Basic HTML strip\n         alert(`[${title}] ${cleanMessage}`);\n    }\n\n}\n\n// --- Initialization ---\n// Ensure DOM is ready before initializing\nfunction initializeWishlistManager() {\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', () => {\n            window.wishlistManager = new WishlistManager();\n        });\n    } else {\n        // DOM is already ready\n        window.wishlistManager = new WishlistManager();\n    }\n}\n\ninitializeWishlistManager();\n\n// Export the singleton instance *after* ensuring it's created\nexport default window.wishlistManager;\n","/**\n * ajax_helper.js - Utility functions for AJAX requests\n * \n * Provides standardized AJAX request functionality with CSRF protection\n * and consistent error handling.\n */\n\n/**\n * Get the CSRF token from cookies\n * @param {string} name - Cookie name\n * @returns {string} - CSRF token value\n */\nexport function getCookie(name) {\n    let cookieValue = null;\n    if (document.cookie && document.cookie !== '') {\n        const cookies = document.cookie.split(';');\n        for (let i = 0; i < cookies.length; i++) {\n            const cookie = cookies[i].trim();\n            if (cookie.substring(0, name.length + 1) === (name + '=')) {\n                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n                break;\n            }\n        }\n    }\n    return cookieValue;\n}\n\n/**\n * Makes an AJAX request and returns the jqXHR object to allow aborting the request if needed\n * @param {string} url - The URL to send the request to\n * @param {string} method - The HTTP method to use (GET, POST, etc.)\n * @param {Object|FormData} data - The data to send with the request\n * @param {Function} successCallback - Called when the request succeeds\n * @param {Function} errorCallback - Called when the request fails\n * @param {boolean} abortable - Whether to return the jqXHR object for aborting (default: true)\n * @param {boolean} processData - Whether to process the data (set to false for FormData)\n * @param {string|boolean} contentType - Content type header or false to let jQuery set it\n * @returns {Object} The jqXHR object if abortable is true, otherwise undefined\n */\nexport function makeAjaxRequest(\n    url, \n    method, \n    data, \n    successCallback, \n    errorCallback, \n    abortable = true,\n    processData = true,\n    contentType = 'application/x-www-form-urlencoded; charset=UTF-8'\n) {\n    // Determine if data is FormData and set appropriate options\n    const isFormData = data instanceof FormData;\n    if (isFormData) {\n        processData = false;\n        contentType = false;\n    }\n    \n    // Set up AJAX options\n    const ajaxOptions = {\n        url: url,\n        method: method,\n        data: data,\n        processData: processData,\n        contentType: contentType,\n        headers: {\n            'X-CSRFToken': getCookie('csrftoken'),\n            'X-Requested-With': 'XMLHttpRequest'\n        },\n        success: function (response) {\n            if (typeof successCallback === \"function\") {\n                // Handle both JSON and HTML responses\n                if (typeof response === 'string' && response.trim().startsWith('<')) {\n                    // If it's HTML content\n                    successCallback({ html: response });\n                } else {\n                    // If it's JSON or other data\n                    successCallback(response);\n                }\n            }\n        },\n        error: function (jqXHR, textStatus, errorThrown) {\n            // Don't log aborted requests as errors\n            if (textStatus !== 'abort') {\n                console.error(\"AJAX Request failed:\", textStatus, errorThrown);\n                if (typeof errorCallback === \"function\") {\n                    errorCallback(jqXHR, textStatus, errorThrown);\n                }\n            }\n        }\n    };\n    \n    // Try to auto-detect the response type\n    if (url.includes('/api/') || url.endsWith('.json')) {\n        ajaxOptions.dataType = 'json';\n    }\n    \n    // Make the request\n    const ajaxRequest = $.ajax(ajaxOptions);\n    \n    // Return the jqXHR object if the request should be abortable\n    if (abortable) {\n        return ajaxRequest;\n    }\n}\n","/**\n * api-client.js - Standardized API client for consistent AJAX operations\n * \n * Provides a higher-level wrapper around AJAX requests with standardized\n * error handling, response parsing, and consistent promise handling.\n */\nimport { makeAjaxRequest, getCookie } from './ajax_helper.js';\n\n/**\n * API Client for consistent handling of AJAX requests\n */\nexport class ApiClient {\n    /**\n     * Create a new ApiClient instance\n     * @param {Object} options - Configuration options\n     * @param {Function} options.errorHandler - Global error handler function\n     * @param {string} options.baseUrl - Base URL for API requests\n     */\n    constructor(options = {}) {\n        this.errorHandler = options.errorHandler || console.error;\n        this.baseUrl = options.baseUrl || '';\n        this.csrfToken = getCookie('csrftoken');\n        this.pendingRequests = [];\n    }\n\n    /**\n     * Builds a complete URL for the API request\n     * @param {string} endpoint - API endpoint\n     * @returns {string} - Complete URL\n     */\n    buildUrl(endpoint) {\n        // If endpoint is already a full URL, return it as is\n        if (endpoint.startsWith('http') || endpoint.startsWith('/')) {\n            return endpoint;\n        }\n        \n        // Otherwise, join baseUrl and endpoint\n        return `${this.baseUrl}/${endpoint}`.replace(/([^:]\\/)\\/+/g, '$1');\n    }\n\n    /**\n     * Make a GET request to fetch data\n     * @param {string} endpoint - API endpoint\n     * @param {Object} params - Query parameters\n     * @param {Object} options - Additional options\n     * @returns {Promise} - Promise resolving with response\n     */\n    get(endpoint, params = {}, options = {}) {\n        return this.request('GET', endpoint, params, options);\n    }\n\n    /**\n     * Make a POST request to create or update data\n     * @param {string} endpoint - API endpoint\n     * @param {Object|FormData} data - Data to send\n     * @param {Object} options - Additional options\n     * @returns {Promise} - Promise resolving with response\n     */\n    post(endpoint, data = {}, options = {}) {\n        return this.request('POST', endpoint, data, options);\n    }\n\n    /**\n     * Make a DELETE request to remove data\n     * @param {string} endpoint - API endpoint\n     * @param {Object} data - Data to send\n     * @param {Object} options - Additional options\n     * @returns {Promise} - Promise resolving with response\n     */\n    delete(endpoint, data = {}, options = {}) {\n        return this.request('DELETE', endpoint, data, options);\n    }\n\n    /**\n     * Make a generic request with specified method\n     * @param {string} method - HTTP method\n     * @param {string} endpoint - API endpoint\n     * @param {Object|FormData} data - Data to send\n     * @param {Object} options - Additional options\n     * @returns {Promise} - Promise resolving with response\n     */\n    request(method, endpoint, data = {}, options = {}) {\n        const url = this.buildUrl(endpoint);\n        const abortable = options.abortable !== false;\n        \n        // Determine if we should process the data (false for FormData)\n        const processData = !(data instanceof FormData);\n        const contentType = processData ? 'application/x-www-form-urlencoded; charset=UTF-8' : false;\n        \n        return new Promise((resolve, reject) => {\n            try {\n                const ajaxRequest = makeAjaxRequest(\n                    url,\n                    method,\n                    data,\n                    (response) => {\n                        // Remove from pending requests\n                        this.removePendingRequest(ajaxRequest);\n                        resolve(response);\n                    },\n                    (jqXHR, textStatus, errorThrown) => {\n                        // Remove from pending requests\n                        this.removePendingRequest(ajaxRequest);\n                        \n                        // Create standardized error object\n                        const error = {\n                            status: jqXHR.status,\n                            statusText: jqXHR.statusText,\n                            responseJSON: jqXHR.responseJSON,\n                            message: jqXHR.responseJSON?.error || errorThrown || \"Request failed\"\n                        };\n                        \n                        // Call the global error handler if provided\n                        if (this.errorHandler && !options.skipGlobalErrorHandler) {\n                            this.errorHandler(error);\n                        }\n                        \n                        reject(error);\n                    },\n                    abortable,\n                    processData,\n                    contentType\n                );\n                \n                // Track the request if abortable\n                if (abortable && ajaxRequest) {\n                    this.pendingRequests.push(ajaxRequest);\n                }\n                \n                // If there's a timeout option, handle it\n                if (options.timeout) {\n                    setTimeout(() => {\n                        if (ajaxRequest && ajaxRequest.readyState < 4) {\n                            ajaxRequest.abort();\n                            reject({\n                                message: 'Request timed out',\n                                status: 0,\n                                statusText: 'timeout'\n                            });\n                        }\n                    }, options.timeout);\n                }\n            } catch (error) {\n                console.error(\"Error making request:\", error);\n                reject({\n                    message: error.message || \"Failed to make request\",\n                    error: error\n                });\n            }\n        });\n    }\n\n    /**\n     * Remove a request from the pending requests list\n     * @param {Object} request - The request to remove\n     */\n    removePendingRequest(request) {\n        const index = this.pendingRequests.indexOf(request);\n        if (index !== -1) {\n            this.pendingRequests.splice(index, 1);\n        }\n    }\n\n    /**\n     * Abort all pending requests\n     */\n    abortAll() {\n        this.pendingRequests.forEach(request => {\n            if (request && typeof request.abort === 'function') {\n                request.abort();\n            }\n        });\n        this.pendingRequests = [];\n    }\n}\n\n// Create a default instance\nexport default new ApiClient();\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * Wishlist Initializer\n * Bootstraps the wishlist functionality when the page loads\n */\n\nimport wishlistManager from './wishlist-manager.js';\n\n/**\n * Initialize wishlist functionality\n */\nfunction initWishlist() {\n    // The wishlist manager is automatically initialized on import,\n    // but we can perform additional initialization here if needed\n    \n    // Check if we're on the wishlist page\n    const isWishlistPage = window.location.pathname.includes('/wishlist/');\n    \n    if (isWishlistPage) {\n        // Initialize special wishlist page functionality\n        initWishlistPage();\n    }\n    \n    console.log('[WishlistInitializer] Wishlist functionality initialized');\n}\n\n/**\n * Initialize wishlist page specific functionality\n */\nfunction initWishlistPage() {\n    // Add any wishlist page specific functionality here\n    console.log('[WishlistInitializer] Wishlist page specific functionality initialized');\n    \n    // Example: Add empty wishlist check\n    const wishlistItems = document.querySelectorAll('.wishlist-item, .product-card');\n    if (wishlistItems.length === 0) {\n        const container = document.querySelector('.container main, .wishlist-container');\n        if (container) {\n            container.innerHTML = `\n                <div class=\"empty-wishlist alert alert-info text-center my-5\">\n                    <i class=\"fas fa-heart-broken mb-3\" style=\"font-size: 3rem;\"></i>\n                    <h3>Your wishlist is empty</h3>\n                    <p class=\"mb-3\">You haven't added any products to your wishlist yet.</p>\n                    <a href=\"/shop/\" class=\"btn btn-primary\">\n                        <i class=\"fas fa-shopping-bag me-2\"></i>Browse Products\n                    </a>\n                </div>\n            `;\n        }\n    }\n}\n\n// Initialize when the DOM is fully loaded\ndocument.addEventListener('DOMContentLoaded', initWishlist);\n\n// Also export the init function to allow manual initialization\nexport { initWishlist };\n"],"names":["apiClient","WishlistManager","_classCallCheck","toastQueue","processingToast","debug","wishlistItems","Set","initialize","_createClass","key","value","_this","initializeWishlistItems","initEventListeners","checkSweetAlert2Availability","document","addEventListener","log","processToastQueue","error","console","_this2","wishlistCountElements","querySelectorAll","length","count","parseInt","textContent","forEach","btn","productId","dataset","add","wishlistDataElement","getElementById","wishlistData","JSON","parse","Array","isArray","id","toString","e","_toConsumableArray","_console","_len","arguments","args","_key","apply","concat","_this3","window","Swal","dispatchEvent","Event","warn","setTimeout","loadSweetAlert2Dynamically","_this4","script","createElement","src","onload","onerror","head","appendChild","_this5","wishlistBtnSelector","hasAttribute","setAttribute","preventDefault","handleWishlistToggle","event","toggleBtn","target","closest","getAttribute","setupMutationObserver","_this6","observer","MutationObserver","mutations","mutation","type","addedNodes","node","nodeType","Node","ELEMENT_NODE","matches","bindWishlistButtonListener","wishlistBtns","observe","body","childList","subtree","_this7","_this8","button","currentTarget","classList","contains","showToast","productName","isCurrentlyInWishlist","has","originalContent","innerHTML","originalDisabledState","disabled","url","post","product_id","then","response","data","_typeof","trim","Error","finalState","errorOccurred","finalIsInWishlist","actionSucceeded","success","isInWishlist","undefined","added","removed","actionType","message","toLowerCase","wishlist_count","updateWishlistCount","location","pathname","includes","removeItemFromWishlistPage","errorMessage","detail","buttonsToRestore","spinner","querySelector","children","firstChild","remove","updateWishlistButtonVisualState","size","updateAllButtonsForProduct","_this9","buttons","icon","_this10","card","container","elementToRemove","style","transition","opacity","transform","height","marginTop","marginBottom","paddingTop","paddingBottom","borderWidth","remainingItems","displayEmptyWishlistMessage","mainContent","wishlistGrid","containerToEmpty","isNaN","element","onanimationend","counterContainer","display","title","push","_this11","toastToShow","shift","displayToast","_this12","Promise","resolve","fallbackToast","iconType","fire","html","toast","position","showConfirmButton","timer","timerProgressBar","customClass","popup","showCloseButton","didOpen","zIndex","stopTimer","resumeTimer","cleanMessage","replace","alert","initializeWishlistManager","readyState","wishlistManager","getCookie","name","cookieValue","cookie","cookies","split","i","substring","decodeURIComponent","makeAjaxRequest","method","successCallback","errorCallback","abortable","processData","contentType","isFormData","FormData","ajaxOptions","headers","startsWith","jqXHR","textStatus","errorThrown","endsWith","dataType","ajaxRequest","$","ajax","ApiClient","options","errorHandler","baseUrl","csrfToken","pendingRequests","buildUrl","endpoint","get","params","request","delete","reject","removePendingRequest","_jqXHR$responseJSON","status","statusText","responseJSON","skipGlobalErrorHandler","timeout","abort","index","indexOf","splice","abortAll","initWishlist","isWishlistPage","initWishlistPage"],"sourceRoot":""}