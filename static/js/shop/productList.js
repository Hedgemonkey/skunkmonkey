/* empty css                             */import{W as l}from"../chunks/WishlistManager.DmSBy4bw.js";class n{constructor(t){this.plm=t,this.filterState={search:"",category:"",sort:"name-asc"},this.searchTimer=null}initializeFilterStateFromUrl(){var t,e,r,i;try{const a=new URLSearchParams(window.location.search);this.filterState={search:a.get("search")||(((t=this.plm.filterContainer)==null?void 0:t.dataset.searchQuery)||"").trim(),category:a.get("category")||(((e=this.plm.filterContainer)==null?void 0:e.dataset.currentCategory)||"").trim(),sort:a.get("sort")||"name-asc"},console.log("Initialized filter state from URL:",this.filterState)}catch(a){console.error("Error initializing filter state from URL:",a),this.filterState={search:(((r=this.plm.filterContainer)==null?void 0:r.dataset.searchQuery)||"").trim(),category:(((i=this.plm.filterContainer)==null?void 0:i.dataset.currentCategory)||"").trim(),sort:"name-asc"}}}handleSearchInput(t){try{this.filterState.search=t.target.value,this.plm.uiManager.updateFilterUI(),clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.plm.urlManager.updateUrl(),this.plm.productGridManager.fetchProducts()},300)}catch(e){console.error("Error handling search input:",e)}}handleSortChange(t){try{this.filterState.sort=t.target.value,this.plm.uiManager.updateFilterUI(),this.plm.urlManager.updateUrl(),this.plm.productGridManager.fetchProducts()}catch(e){console.error("Error handling sort change:",e)}}handleCategoryChange(t){try{let e=[];t.target.selectedOptions?e=Array.from(t.target.selectedOptions).map(r=>r.value):t.target.options&&t.target.multiple?e=Array.from(t.target.options).filter(r=>r.selected).map(r=>r.value):t.target.value&&(e=[t.target.value]),this.filterState.category=e.join(","),this.plm.uiManager.updateFilterUI(),this.plm.urlManager.updateUrl(),this.plm.productGridManager.fetchProducts()}catch(e){console.error("Error handling category change:",e)}}handleClearSearch(){try{this.filterState.search="",this.plm.searchInput&&(this.plm.searchInput.value=""),this.plm.uiManager.updateFilterUI(),this.plm.urlManager.updateUrl(),this.plm.productGridManager.fetchProducts()}catch(t){console.error("Error clearing search:",t)}}handleClearCategories(){try{if(this.filterState.category="",this.plm.categorySelect)if(typeof $<"u"&&$.fn&&typeof $.fn.select2<"u")try{$(this.plm.categorySelect).val(null).trigger("change")}catch(t){console.warn("Error with Select2 clearing:",t),Array.from(this.plm.categorySelect.options).forEach(e=>e.selected=!1)}else Array.from(this.plm.categorySelect.options).forEach(t=>t.selected=!1);this.plm.uiManager.updateFilterUI(),this.plm.urlManager.updateUrl(),this.plm.productGridManager.fetchProducts()}catch(t){console.error("Error clearing categories:",t)}}handleResetAll(){try{if(this.filterState={search:"",category:"",sort:"name-asc"},this.plm.searchInput&&(this.plm.searchInput.value=""),this.plm.sortSelect&&(this.plm.sortSelect.value="name-asc"),this.plm.categorySelect)if(typeof $<"u"&&$.fn&&typeof $.fn.select2<"u")try{$(this.plm.categorySelect).val(null).trigger("change")}catch(t){console.warn("Error with Select2 resetting:",t),Array.from(this.plm.categorySelect.options).forEach(e=>e.selected=!1)}else Array.from(this.plm.categorySelect.options).forEach(t=>t.selected=!1);this.plm.uiManager.updateFilterUI(),this.plm.urlManager.updateUrl(),this.plm.productGridManager.fetchProducts()}catch(t){console.error("Error resetting filters:",t)}}removeCategoryById(t){try{const r=(this.filterState.category?this.filterState.category.split(",").filter(i=>i):[]).filter(i=>i!==t);if(this.filterState.category=r.join(","),this.plm.categorySelect){const i=this.plm.categorySelect.querySelector(`option[value="${t}"]`);if(i&&(i.selected=!1),typeof $<"u"&&$.fn&&typeof $.fn.select2<"u")try{$(this.plm.categorySelect).trigger("change")}catch(a){console.warn("Error triggering Select2 change:",a)}}this.plm.uiManager.updateFilterUI(),this.plm.urlManager.updateUrl(),this.plm.productGridManager.fetchProducts()}catch(e){console.error("Error removing category:",e)}}getFilterState(){return{...this.filterState}}setFilterState(t){this.filterState={...this.filterState,...t}}initializeFilterControls(){try{const e=new URLSearchParams(window.location.search).get("sort");if(this.plm.sortSelect&&e&&(this.plm.sortSelect.value=e,this.filterState.sort=e),this.plm.categorySelect&&typeof $<"u"&&$.fn&&typeof $.fn.select2<"u")try{$(this.plm.categorySelect).select2({placeholder:"Select Categories",allowClear:!0,width:"100%"})}catch(r){console.warn("Error initializing Select2:",r)}}catch(t){console.error("Error initializing controls:",t)}}bindFilterEvents(){try{this.plm.searchInput&&this.plm.searchInput.addEventListener("input",this.handleSearchInput.bind(this)),this.plm.sortSelect&&this.plm.sortSelect.addEventListener("change",this.handleSortChange.bind(this)),this.plm.categorySelect&&this.plm.categorySelect.addEventListener("change",this.handleCategoryChange.bind(this)),this.plm.clearSearchBtn&&this.plm.clearSearchBtn.addEventListener("click",this.handleClearSearch.bind(this)),this.plm.clearCategoriesBtn&&this.plm.clearCategoriesBtn.addEventListener("click",this.handleClearCategories.bind(this)),this.plm.resetAllBtn&&this.plm.resetAllBtn.addEventListener("click",this.handleResetAll.bind(this)),this.plm.filterToggleBtn&&this.plm.filterToggleBtn.addEventListener("click",this.handleFilterToggle.bind(this)),document.addEventListener("click",t=>{try{if(t.target.closest(".search-summary .btn-close")&&this.handleClearSearch(),t.target.closest(".categories-summary .btn-close")&&this.handleClearCategories(),t.target.closest(".tag-remove")){const e=t.target.closest(".tag-remove").dataset.categoryId;e&&this.removeCategoryById(e)}}catch(e){console.error("Error handling click event:",e)}})}catch(t){console.error("Error binding events:",t)}}handleFilterToggle(){try{this.plm.filterContainer&&this.plm.filterContainer.classList.toggle("show")}catch(t){console.error("Error toggling filter:",t)}}}class c{constructor(t){this.plm=t}initializeFilterDomReferences(){this.plm.productGridContainer=document.getElementById("product-grid-container"),this.plm.searchInput=document.querySelector(".filter-search"),this.plm.sortSelect=document.querySelector(".filter-sort"),this.plm.categorySelect=document.querySelector(".filter-category"),this.plm.clearSearchBtn=document.querySelector(".clear-search"),this.plm.resetAllBtn=document.querySelector(".reset-all-filters"),this.plm.filterToggleBtn=document.querySelector(".filter-toggle"),this.plm.filterOptions=document.getElementById("filterOptions"),this.plm.searchDisplay=document.querySelector(".search-display"),this.plm.searchTerm=document.querySelector(".search-term"),this.plm.searchTermSummary=document.querySelector(".search-term-summary"),this.plm.searchSummary=document.querySelector(".search-summary"),this.plm.categoriesDisplay=document.querySelector(".categories-display"),this.plm.categoryCountDisplay=document.querySelector(".category-count-display"),this.plm.categoriesSummary=document.querySelector(".categories-summary"),this.plm.categoryCountSummary=document.querySelector(".category-count-summary"),this.plm.categoryTagsContainer=document.getElementById("selectedCategoriesTags"),this.plm.clearCategoriesBtn=document.querySelector(".clear-categories-btn"),this.plm.itemCountDisplay=document.querySelector(".item-count"),this.plm.productCountDisplay=document.getElementById("product-count")}updateFilterUI(){try{const t=this.plm.filterManager.getFilterState();this.plm.searchTerm&&(this.plm.searchTerm.textContent=t.search),this.plm.searchTermSummary&&(this.plm.searchTermSummary.textContent=t.search),this.plm.searchDisplay&&this.plm.searchDisplay.classList.toggle("d-none",!t.search),this.plm.searchSummary&&this.plm.searchSummary.classList.toggle("d-none",!t.search);const r=(t.category?t.category.split(",").filter(i=>i):[]).length;this.plm.categoryCountDisplay&&(this.plm.categoryCountDisplay.textContent=r),this.plm.categoryCountSummary&&(this.plm.categoryCountSummary.textContent=r),this.plm.categoriesDisplay&&this.plm.categoriesDisplay.classList.toggle("d-none",r===0),this.plm.categoriesSummary&&this.plm.categoriesSummary.classList.toggle("d-none",r===0),this.updateCategoryTags()}catch(t){console.error("Error updating UI:",t)}}updateCategoryTags(){try{if(!this.plm.categoryTagsContainer)return;const t=this.plm.filterManager.getFilterState(),e=t.category?t.category.split(",").filter(r=>r):[];this.plm.categoryTagsContainer.innerHTML="",e.forEach(r=>{if(!r)return;let i=r;if(this.plm.categorySelect){const o=this.plm.categorySelect.querySelector(`option[value="${r}"]`);o&&(i=o.textContent.trim())}const a=document.createElement("span");a.className="badge bg-primary me-2 mb-2 category-tag",a.innerHTML=`
                    ${this.escapeHtml(i)}
                    <button type="button" class="btn-close btn-close-white ms-2 tag-remove"
                            data-category-id="${this.escapeHtml(r)}"
                            aria-label="Remove category">
                    </button>
                `,this.plm.categoryTagsContainer.appendChild(a)})}catch(t){console.error("Error updating category tags:",t)}}handleFilterToggle(){try{if(!this.plm.filterOptions)return;const t=this.plm.filterOptions.classList.contains("show");if(this.plm.filterOptions.classList.toggle("show"),this.plm.filterToggleBtn){this.plm.filterToggleBtn.classList.toggle("collapsed",!t),this.plm.filterToggleBtn.setAttribute("aria-expanded",t?"false":"true");const e=this.plm.filterToggleBtn.querySelector(".filter-toggle-text");e&&(e.textContent=t?"Show Filters":"Hide Filters")}}catch(t){console.error("Error toggling filter visibility:",t)}}positionWishlistButtons(){try{document.querySelectorAll(".product-card").forEach(e=>{const r=e.querySelector(".add-to-wishlist-btn, .remove-wishlist-btn"),i=e.querySelector(".badge");r&&(r.classList.remove("top-badge","top-no-badge"),i&&!i.classList.contains("d-none")?r.classList.add("top-badge"):r.classList.add("top-no-badge"))})}catch(t){console.error("Error positioning wishlist buttons:",t)}}showLoading(){this.plm.productGridContainer&&this.plm.productGridContainer.classList.add("loading")}hideLoading(){this.plm.productGridContainer&&this.plm.productGridContainer.classList.remove("loading")}updateProductCount(t){try{this.plm.itemCountDisplay&&(this.plm.itemCountDisplay.textContent=t),this.plm.productCountDisplay&&(this.plm.productCountDisplay.textContent=t)}catch(e){console.error("Error updating product count:",e)}}escapeHtml(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,r=>e[r])}hasEssentialFilterElements(){return this.plm.productGridContainer?!0:(console.warn("Product List Manager: product-grid-container not found in the DOM"),!1)}}class h{constructor(t){this.plm=t}updateUrl(t=!1){try{const e=new URL(window.location.href),r=this.plm.filterManager.getFilterState();e.searchParams.delete("search"),e.searchParams.delete("category"),e.searchParams.delete("sort"),e.searchParams.delete("page"),r.search&&e.searchParams.set("search",r.search),r.category&&e.searchParams.set("category",r.category),r.sort&&r.sort!=="name-asc"&&e.searchParams.set("sort",r.sort),t?window.history.replaceState({},"",e.toString()):window.history.pushState({},"",e.toString()),console.log("Updated URL to:",e.toString())}catch(e){console.error("Error updating URL:",e)}}bindNavigationEvents(){try{window.addEventListener("popstate",()=>{console.log("Browser navigation detected, updating filters from URL"),this.plm.filterManager.initializeFilterStateFromUrl(),this.plm.uiManager.updateFilterUI(),this.plm.productGridManager.fetchProducts()})}catch(t){console.error("Error binding navigation events:",t)}}initializeFromUrl(){this.plm.filterManager.initializeFilterStateFromUrl(),this.syncUIWithFilters()}syncUIWithFilters(){try{const t=this.plm.filterManager.getFilterState();if(this.plm.searchInput&&(this.plm.searchInput.value=t.search||""),this.plm.sortSelect&&(this.plm.sortSelect.value=t.sort||"name-asc"),this.plm.categorySelect&&t.category){const e=t.category.split(",").filter(r=>r);if(Array.from(this.plm.categorySelect.options).forEach(r=>r.selected=!1),e.forEach(r=>{const i=this.plm.categorySelect.querySelector(`option[value="${r}"]`);i&&(i.selected=!0)}),typeof $<"u"&&$.fn&&typeof $.fn.select2<"u")try{$(this.plm.categorySelect).trigger("change")}catch(r){console.warn("Error syncing Select2:",r)}}}catch(t){console.error("Error syncing UI with filters:",t)}}}class d{constructor(t){this.plm=t,this.originalGridHtml=""}fetchProducts(){this.plm.productGridContainer&&(this.plm.uiManager.showLoading(),this.originalGridHtml=this.plm.productGridContainer.innerHTML);try{const t=this.getBaseUrl(),e=new URL(t),r=this.plm.filterManager.getFilterState();r.search&&e.searchParams.set("search",r.search),r.category&&e.searchParams.set("category",r.category),r.sort&&e.searchParams.set("sort",r.sort),e.searchParams.set("_",Date.now()),console.log("Fetching products from:",e.toString()),fetch(e.toString(),{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"same-origin"}).then(i=>{if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return i.json()}).then(i=>{this.plm.productGridContainer&&i.html?(this.plm.productGridContainer.innerHTML=i.html,this.plm.uiManager.positionWishlistButtons(),this.updateProductCountFromGrid(),document.dispatchEvent(new CustomEvent("productsLoaded",{detail:{container:this.plm.productGridContainer,html:i.html}}))):this.showErrorMessage("No products found")}).catch(i=>{console.error("Error fetching products:",i),this.plm.productGridContainer&&this.originalGridHtml&&(this.plm.productGridContainer.innerHTML=this.originalGridHtml),this.showErrorMessage("Failed to load products. Please try again.")}).finally(()=>{this.plm.uiManager.hideLoading()})}catch(t){console.error("Error in fetchProducts:",t),this.plm.uiManager.hideLoading(),this.showErrorMessage("An error occurred while loading products.")}}getBaseUrl(){try{if(this.plm.productListUrl){if(this.plm.productListUrl.startsWith("/"))return`${window.location.protocol}//${window.location.host}${this.plm.productListUrl}`;if(this.isValidUrl(this.plm.productListUrl))return this.plm.productListUrl}return this.isValidUrl(window.location.href)?window.location.href:`${window.location.protocol}//${window.location.host}${window.location.pathname}`}catch(t){return console.error("Error getting base URL:",t),window.location.href}}isValidUrl(t){try{return new URL(t),!0}catch{return!1}}updateProductCountFromGrid(){try{if(!this.plm.productGridContainer)return;const e=this.plm.productGridContainer.querySelectorAll(".product-card, .product-item").length;this.plm.uiManager.updateProductCount(e),console.log(`Updated product count: ${e} products found`)}catch(t){console.error("Error updating product count from grid:",t)}}showErrorMessage(t){try{if(!this.plm.productGridContainer)return;const e=`
                <div class="alert alert-danger text-center" role="alert">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    ${this.escapeHtml(t)}
                    <button type="button" class="btn btn-outline-danger btn-sm ms-3" onclick="window.location.reload()">
                        <i class="fas fa-refresh me-1"></i> Retry
                    </button>
                </div>
            `;this.plm.productGridContainer.innerHTML=e}catch(e){console.error("Error showing error message:",e)}}escapeHtml(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,r=>e[r])}}class g{constructor(){try{this.filterManager=new n(this),this.uiManager=new c(this),this.wishlistManager=new l(this),this.urlManager=new h(this),this.productGridManager=new d(this),this.initializeProductGridFeatures(),this.filterContainer=document.getElementById("dynamic-filter-container"),this.filterContainer||console.warn("Product List Manager: dynamic-filter-container not found in the DOM"),this.filterContainer&&(this.productListUrl=this.filterContainer.dataset.productListUrl,this.productListUrl||(console.warn("Product List Manager: No product list URL provided in data-product-list-url attribute"),this.productListUrl=window.location.href),this.filterManager.initializeFilterStateFromUrl(),this.uiManager.initializeFilterDomReferences(),this.uiManager.hasEssentialFilterElements()&&(this.initializeFilterControls(),this.bindFilterEvents(),this.urlManager.bindNavigationEvents(),this.uiManager.updateFilterUI(),setTimeout(()=>{this.productGridManager.fetchProducts()},100)))}catch(t){console.error("Error initializing Product List Manager:",t)}}initializeProductGridFeatures(){try{this.positionWishlistButtons(),window.wishlistManager||document.querySelector('script[src*="wishlist-initializer"]')||typeof window.initWishlist=="function"?console.log("[ProductListManager] Skipping wishlist event handlers (WishlistInitializer detected)"):(document.addEventListener("click",e=>{const r=e.target.closest(".add-to-wishlist-btn, .remove-wishlist-btn");r&&this.handleWishlistButtonClick(e,r)}),console.log("[ProductListManager] Added wishlist event handlers (no WishlistInitializer detected)")),window.addEventListener("resize",()=>{this.positionWishlistButtons()}),document.addEventListener("productsLoaded",()=>{this.positionWishlistButtons()})}catch(t){console.error("Error initializing product grid features:",t)}}initializeFilterDomReferences(){return this.uiManager.initializeFilterDomReferences()}hasEssentialFilterElements(){return this.uiManager.hasEssentialFilterElements()}initializeFilterControls(){return this.filterManager.initializeFilterControls()}bindFilterEvents(){return this.filterManager.bindFilterEvents()}handleSearchInput(t){return this.filterManager.handleSearchInput(t)}handleSortChange(t){return this.filterManager.handleSortChange(t)}handleCategoryChange(t){return this.filterManager.handleCategoryChange(t)}handleClearSearch(){return this.filterManager.handleClearSearch()}handleClearCategories(){return this.filterManager.handleClearCategories()}handleResetAll(){return this.filterManager.handleResetAll()}handleFilterToggle(){return this.uiManager.handleFilterToggle()}removeCategoryById(t){return this.filterManager.removeCategoryById(t)}updateFilterUI(){return this.uiManager.updateFilterUI()}updateCategoryTags(){return this.uiManager.updateCategoryTags()}isValidUrl(t){return this.productGridManager.isValidUrl(t)}getBaseUrl(){return this.productGridManager.getBaseUrl()}fetchProducts(){return this.productGridManager.fetchProducts()}handleWishlistButtonClick(t,e){return this.wishlistManager.handleWishlistButtonClick(t,e)}findHeartIcon(t){return this.wishlistManager.findHeartIcon(t)}getIconClasses(t){return this.wishlistManager.getIconClasses(t)}setIconClasses(t,e){return this.wishlistManager.setIconClasses(t,e)}replaceFontAwesomeIcon(t,e){return this.wishlistManager.replaceFontAwesomeIcon(t,e)}positionWishlistButtons(){return this.wishlistManager.positionWishlistButtons()}updateWishlistCounter(t){return this.wishlistManager.updateWishlistCounter(t)}getCookie(t){return this.wishlistManager.getCookie(t)}showToast(t,e,r="info"){return this.wishlistManager.showToast(t,e,r)}initializeFilterStateFromUrl(){return this.urlManager.initializeFilterStateFromUrl()}bindNavigationEvents(){return this.urlManager.bindNavigationEvents()}updateUrl(t=!1){return this.urlManager.updateUrl(t)}}document.addEventListener("DOMContentLoaded",function(){try{window.productListManager=new g}catch(s){console.error("Fatal error initializing Product List Manager:",s);const t=document.getElementById("product-grid-container");t&&(t.innerHTML='<div class="alert alert-danger">There was an error initializing the product list. Please refresh the page or contact support.</div>')}});
