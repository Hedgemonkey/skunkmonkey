/* empty css                               */import{a as n}from"../common/apiClient.js";import"../chunks/ajax_helper.EulIYOr7.js";import"../chunks/chunks/vendor/common.Dz0GDR6V.js";class a{constructor(){this.comparisonItems=new Set,this.initialize()}initialize(){try{this.initializeComparisonItems(),this.bindEvents()}catch(e){console.error("Error initializing Comparison Manager:",e)}}initializeComparisonItems(){const e=document.querySelectorAll(".comparison-count");if(e.length>0){const t=parseInt(e[0].textContent,10);console.log("Initial comparison count:",t)}document.querySelectorAll(".btn-success.add-to-comparison-btn, .toggle-comparison-btn.btn-success").forEach(t=>{const r=t.dataset.productId;r&&(this.comparisonItems.add(r),console.log("Added product to initial comparison set:",r))});const o=document.getElementById("comparison-data");if(o&&o.textContent&&o.textContent.trim()!=="")try{const t=JSON.parse(o.textContent);Array.isArray(t)&&(t.forEach(r=>this.comparisonItems.add(r.toString())),console.log("Initialized comparison items from data element:",t))}catch(t){console.error("Error parsing comparison data:",t),console.log("Falling back to empty comparison due to parsing error")}else console.log("No comparison data element found or data is empty");console.log("Initialized comparison items:",[...this.comparisonItems])}bindEvents(){document.addEventListener("click",e=>{const o=e.target.closest(".add-to-comparison-btn, .remove-from-comparison, .comparison-btn, .toggle-comparison-btn");o&&(e.preventDefault(),this.handleComparisonButtonClick(o))})}handleComparisonButtonClick(e){const o=e.dataset.productId;if(e.dataset.productName,!o){console.error("ComparisonManager: No product ID found on button"),this.showToast("Error","Product information missing","error");return}this.isProductInComparison(e);const t=this.captureButtonState(e);this.setLoadingState(e);const r=`/shop/comparison/toggle/${o}/`;n.post(r,{},{"X-Requested-With":"XMLHttpRequest"}).then(s=>{if(s.success){this.updateButtonState(e,s.isInComparison,o),this.updateComparisonCounter(s.comparison_count);const i=s.added?"Added to":"Removed from";this.showToast(`${i} Comparison`,s.message,s.added?"success":"info"),s.removed&&window.location.pathname.includes("/comparison/")&&setTimeout(()=>window.location.reload(),1e3)}else this.restoreButtonState(e,t),this.showToast("Notice",s.message||"Failed to update comparison list","warning")}).catch(s=>{console.error("Error updating comparison:",s),this.restoreButtonState(e,t),this.showToast("Error","Failed to update comparison list","error")})}isProductInComparison(e){return!!(e.classList.contains("btn-success")||e.classList.contains("active")||(e.getAttribute("href")||"").includes("remove_from_comparison"))}captureButtonState(e){return{innerHTML:e.innerHTML,className:e.className,href:e.getAttribute("href"),title:e.getAttribute("title")}}setLoadingState(e){const o=e.querySelector("i"),t=o?o.className:"fas fa-balance-scale";e.innerHTML='<div class="spinner-border spinner-border-sm me-1" role="status"></div>',e.disabled=!0,e.dataset.originalIcon=t}updateButtonState(e,o,t){e.disabled=!1,e.classList.remove("btn-outline-secondary","btn-success","active"),o?(e.classList.add("btn-success"),e.innerHTML='<i class="fas fa-check me-1"></i> Compared',e.setAttribute("title","Remove from comparison"),e.setAttribute("href",`/comparison/remove/${t}/`)):(e.classList.add("btn-outline-secondary"),e.innerHTML='<i class="fas fa-balance-scale me-1"></i> Compare',e.setAttribute("title","Add to comparison"),e.setAttribute("href",`/comparison/add/${t}/`))}restoreButtonState(e,o){e.disabled=!1,e.innerHTML=o.innerHTML,e.className=o.className,o.href&&e.setAttribute("href",o.href),o.title&&e.setAttribute("title",o.title)}updateComparisonCounter(e){const o=document.querySelectorAll(".comparison-count");o.length>0&&e!==void 0&&o.forEach(t=>{t.textContent=e})}showToast(e,o,t="info"){const r=t==="danger"?"error":t;typeof window.Swal<"u"?(console.log("Showing toast with SweetAlert2:",e,o,r),window.Swal.fire({title:e,text:o,icon:r,toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:s=>{s.addEventListener("mouseenter",window.Swal.stopTimer),s.addEventListener("mouseleave",window.Swal.resumeTimer)}})):(console.warn("SweetAlert2 not available for toast:",e,o),alert(`${e}: ${o}`))}}document.addEventListener("DOMContentLoaded",()=>{typeof window.Swal>"u"?console.warn("SweetAlert2 is not available. Toast notifications will fall back to alerts."):console.log("SweetAlert2 is available for ComparisonManager."),window.comparisonManager=new a});
