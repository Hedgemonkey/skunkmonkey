import{$ as y}from"../chunks/chunks/vendor/common.Dz0GDR6V.js";document.addEventListener("DOMContentLoaded",function(){const i=document.getElementById("dynamic-filter-container");if(!i)return;const k=i.dataset.productListUrl,D={search:i.dataset.searchQuery||"",category:i.dataset.currentCategory||"",sort:"name-asc"},l=document.querySelector(".filter-search"),d=document.querySelector(".filter-sort"),s=document.querySelector(".filter-category"),h=document.querySelector(".clear-search"),p=document.querySelector(".reset-all-filters"),S=document.querySelector(".filter-toggle"),H=document.getElementById("filterOptions"),L=document.querySelector(".search-display"),v=document.querySelector(".search-term"),C=document.querySelector(".search-term-summary"),E=document.querySelector(".search-summary"),q=document.querySelector(".categories-display"),T=document.querySelector(".category-count-display"),I=document.querySelector(".categories-summary"),x=document.querySelector(".category-count-summary"),f=document.getElementById("selectedCategoriesTags"),B=document.querySelector(".clear-categories-btn"),w=document.querySelector(".item-count"),b=document.getElementById("product-count"),n=document.getElementById("product-grid-container");let e={...D};typeof y.fn.select2<"u"&&s&&y(s).select2({placeholder:"Select Categories",allowClear:!0,width:"100%"});function r(){if(l&&(l.value=e.search),d&&(d.value=e.sort),s&&typeof y.fn.select2<"u"){const o=e.category?e.category.split(","):[];y(s).val(o).trigger("change")}v&&(v.textContent=e.search),C&&(C.textContent=e.search),L&&L.classList.toggle("d-none",!e.search),E&&E.classList.toggle("d-none",!e.search);const t=e.category?e.category.split(",").filter(o=>o).length:0;T&&(T.textContent=t),x&&(x.textContent=t),q&&q.classList.toggle("d-none",t===0),I&&I.classList.toggle("d-none",t===0),M()}function M(){if(!f||(f.innerHTML="",!e.category))return;const t=e.category.split(",").filter(o=>o);t.length!==0&&t.forEach(o=>{const u=Array.from(s.options).find(m=>m.value===o);if(!u)return;const a=u.textContent.trim(),g=document.createElement("div");g.className="category-tag",g.innerHTML=`
                <span class="tag-text">${a}</span>
                <button type="button" class="tag-remove" data-category-id="${o}">
                    <i class="fas fa-times"></i>
                </button>
            `,f.appendChild(g),g.querySelector(".tag-remove").addEventListener("click",function(){const m=this.dataset.categoryId;A(m)})})}function A(t){const u=e.category.split(",").filter(a=>a).filter(a=>a!==t);e.category=u.join(","),r(),c()}function c(){n&&n.classList.add("loading");let t=new URL(k,window.location.origin);e.search&&t.searchParams.append("search",e.search),e.category&&t.searchParams.append("category",e.category),e.sort&&t.searchParams.append("sort",e.sort),fetch(t,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(o=>o.json()).then(o=>{n&&(n.innerHTML=o.html,n.classList.remove("loading")),w&&(w.textContent=o.count),b&&(b.textContent=o.count),P()}).catch(o=>{console.error("Error fetching products:",o),n&&(n.classList.remove("loading"),n.innerHTML='<div class="alert alert-danger">Error loading products. Please try again.</div>')})}function P(){document.querySelectorAll(".wishlist-toggle").forEach(t=>{t.addEventListener("click",function(o){typeof handleWishlistToggle=="function"&&handleWishlistToggle(o)})})}l&&l.addEventListener("input",function(){e.search=this.value,r(),clearTimeout(this.timer),this.timer=setTimeout(c,300)}),d&&d.addEventListener("change",function(){e.sort=this.value,r(),c()}),s&&s.addEventListener("change",function(){const t=Array.from(this.selectedOptions).map(o=>o.value);e.category=t.join(","),r(),c()}),h&&h.addEventListener("click",function(){e.search="",r(),c()}),B&&B.addEventListener("click",function(){e.category="",r(),c()}),p&&p.addEventListener("click",function(){e={search:"",category:"",sort:"name-asc"},r(),c()}),S&&S.addEventListener("click",function(){const t=H.classList.contains("show");this.classList.toggle("collapsed",!t),this.setAttribute("aria-expanded",t?"false":"true"),this.querySelector(".filter-toggle-text").textContent=t?"Show Filters":"Hide Filters"}),document.addEventListener("click",function(t){t.target.closest(".search-summary .btn-close")&&(e.search="",r(),c()),t.target.closest(".categories-summary .btn-close")&&(e.category="",r(),c())}),r(),c()});
