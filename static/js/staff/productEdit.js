import{a as h}from"../chunks/chunks/vendor/common.Dz0GDR6V.js";import{M as f}from"../chunks/chunks/vendor/bootstrap.DA4YfA_0.js";class y{constructor(){this.cropper=null,this.cropperConfig={aspectRatio:1,viewMode:2,minContainerWidth:300,minContainerHeight:300,minCropBoxWidth:200,minCropBoxHeight:200,responsive:!0,autoCropArea:.8}}initImageCropper(){const r=document.getElementById("id_image"),o=document.getElementById("image-preview"),t=document.getElementById("no-image"),c=document.getElementById("cropperModal"),n=document.getElementById("image-to-crop"),s=document.getElementById("crop-btn"),l=document.getElementById("cropped-image-data"),i=document.getElementById("remove-image-btn"),d=document.getElementById("product-form");if(!r||!o){console.error("Product editor: Critical elements not found");return}console.log("Initializing Bootstrap modal for image cropper");const a=new f(c);console.log("Bootstrap modal initialized:",a),r.addEventListener("change",e=>{const m=e.target.files[0];if(!m)return;const p=new FileReader;p.onload=g=>{n.src=g.target.result,console.log("Image loaded into cropper:",n.src.substring(0,30)+"..."),console.log("Showing modal...");try{a.show(),console.log("Modal shown successfully")}catch(u){console.error("Error showing modal:",u)}c.addEventListener("shown.bs.modal",()=>{this.cropper&&this.cropper.destroy(),this.cropper=new h(n,this.cropperConfig)},{once:!0})},p.readAsDataURL(m)}),s&&s.addEventListener("click",()=>{if(!this.cropper)return;const e=this.cropper.getCroppedCanvas({minWidth:256,minHeight:256,maxWidth:1e3,maxHeight:1e3}).toDataURL();o.src=e,o.classList.remove("d-none"),t&&(t.style.display="none"),l&&(l.value=e),a.hide(),this.cropper.destroy(),this.cropper=null}),i&&i.addEventListener("click",()=>{r.value="",o.src="",o.classList.add("d-none"),t&&(t.style.display="block");const e=document.createElement("input");e.type="hidden",e.name="remove_image",e.value="true",d.appendChild(e),i.style.display="none"}),d&&d.addEventListener("submit",()=>{console.log("Product form submitted")})}}const v=new y;window.ProductEditor=v;
