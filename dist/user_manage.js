/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./static/js/users/manage.js":
/*!***********************************!*\
  !*** ./static/js/users/manage.js ***!
  \***********************************/
/***/ (() => {

eval("$(document).ready(function () {\n\n    let currentUrl = null;\n\n    function loadContent(targetDiv, url) {\n        console.log(\"loadContent called with url:\", url);\n        if (url === currentUrl) {  // If same URL clicked, hide the div\n            $(targetDiv).hide();\n            currentUrl = null;\n        } else {                    // Otherwise (different URL), load content\n            $(targetDiv + \" .card-body\").load(url, function (response, status, xhr) {\n                if (status == \"error\") {\n                    const errorMessage = \"Sorry, but there was an error loading the content. \"; //error handling added\n                    $(targetDiv + \" .card-body\").html(errorMessage + xhr.status + \" \" + xhr.statusText);\n                    $(targetDiv).show(); // Show the div even on error to display the message\n                } else {\n                    console.log(\"Content loaded successfully from:\", url);\n                    currentUrl = url; // Update currentUrl after successful load\n                    attachFormSubmitHandler(targetDiv); // Attach form handler\n                    $(targetDiv).show();\n                }\n            });\n        }\n    }\n\n    function attachFormSubmitHandler(targetDiv) {\n        $(targetDiv + \" form\").submit(function (event) {\n            event.preventDefault();\n            const form = $(this);\n\n            const url = form.attr(\"action\");\n            const formData = form.serialize();\n\n            console.log(\"Form submitting to URL:\", url);\n\n            $.ajax({\n                type: \"POST\",\n                url: url,\n                data: formData,\n                success: function (response) {\n                    $(targetDiv + \" .card-body\").html(response);\n                    attachFormSubmitHandler(targetDiv); // Reattach the handler after content update\n\n                },\n                error: function (xhr, status, error) {\n                    console.error(\"AJAX error:\", error, xhr.status, xhr.statusText);\n                    var msg = \"Sorry, but there was an error: \";\n                    $(targetDiv + \" .card-body\").html(msg + xhr.status + \" \" + error); // Update on error\n                    attachFormSubmitHandler(targetDiv); // Reattach the handler\n\n                }\n            });\n        });\n    }\n\n    $(document).on('click', '#cancel-edit, #view-details, #change-email-link, #change-password-link, #social-connections-link', function (event) {\n        event.preventDefault();\n        const url = $(this).data(\"url\");\n        loadContent(\"#manage-details\", url);\n\n    });\n\n    $(document).on('click', '#edit-user-link', function (event) {  // \"Edit\" click handler\n        event.preventDefault();\n        console.log(\"Edit User link clicked\");\n        const url = $(this).data(\"url\");\n        currentUrl = url;\n        $(\"#user-details\").load(url, function (response, status, xhr) { //Simplified logic\n            if (status == \"error\") {\n                var msg = \"Sorry but there was an error: \";\n                $(\"#user-details\").html(msg + xhr.status + \" \" + xhr.statusText);\n            }\n            //After initial content load:\n            attachFormSubmitHandler(\"#user-details\");\n            $(\"#edit-user-link\").hide();\n\n            $(\"#save-user-link\").show(); // Add Save button\n            $(\"#cancel-edit\").show(); // Add Cancel button\n            $(document).on(\"click\", \"#save-user-link\", function (event) {\n                event.preventDefault();\n\n                $(\"#user-details-form\").submit();\n\n            });\n            //Click handler for cancel button\n            $(\"#cancel-edit\").click(function (event) {\n                event.preventDefault();\n                const url = $(this).data(\"url\");\n                $(\"#user-details\").load(url, function (response, status, xhr) {\n                    if (status === \"error\") {\n                        // ... (Handle errors if necessary) ...\n                    }\n\n                    attachFormSubmitHandler(\"#user-details\"); // Reattach event handlers\n                    currentUrl = url;\n\n                });\n                $(\"#user-details\").show();\n            });\n\n        });\n        $(document).on(\"submit\", \"#user-details form\", function (event) {\n            event.preventDefault();\n            const form = $(this);\n            const url = form.attr(\"action\");\n            const formData = form.serialize();\n\n            $.ajax({\n                type: \"POST\",\n                url: url,\n                data: formData,\n                success: function (response) {\n                    $(\"#manage-details .card-body\").html(response);  // Replace content of #user-details\n                    attachFormSubmitHandler(\"#manage-details .card-body\"); // Reattach\n\n                },\n                error: function (xhr, status, error) {\n                    if (xhr.status === 400) { //Handle form errors\n                        const errors = JSON.parse(xhr.responseText);\n                        $(\"#user-details\").html(errors.form);  // Update the form with errors\n                        console.log(errors.errors)\n                        attachFormSubmitHandler(\"#user-details\"); // Reattach event listeners\n                    } else {\n                        var msg = \"Sorry but there was an error: \";\n                        $(\"#user-details .card-body\").html(msg + xhr.status + \" \" + error);\n\n                    }\n\n                }\n            });\n        });\n    });\n});\n\n//# sourceURL=webpack://skunkmonkey/./static/js/users/manage.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./static/js/users/manage.js"]();
/******/ 	
/******/ })()
;